\newenvironment{prettylist}{
	\begin{list}{
		\footnotesize\raisebox{0pt}{\small\ding{121}}
	}{
		\setlength\topsep{2pt plus 1pt minus 1pt}
		\setlength\leftmargin{2em}
		\setlength\rightmargin{0pt}
		\setlength\itemsep{1pt plus.1pt}
		\setlength\parskip{0pt}
		\setlength\parsep{0pt}
		\setlength\itemindent{0pt}
	}
}{
	\end{list}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% These are the general sections to include.  %
%                                             %
% You can alter some names, but follow the    %
% suggestions in the NSF guidelines.          %
%                                             %
% If spacing is tight, play with negative     %
% vspaces w/in the text to reduce whitespace. %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 1: Introduction    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{intro}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 2: Overview        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{background}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 3: Research Plan   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Research Methodology}
\label{sec:methods}

The following section introduces the methodologies and technical contributions of the Jetset, \emph{Story Beyond the Eye}, and InteGreat works.
In each subsection, an overview of the work is provided and then followed by an explanation of the specific technical contributions the dissertation will expand upon and discuss.

\subsection{Jetset}

The Jetset system uses symbolic execution to infer what behavior firmware expects from a target hardware device.
It recovers traces of the expected I/O behavior, and then generates device models for hardware peripherals in C, allowing the an analyst to boot the firmware in an emulator.
Jetset was applied to 13 firmware images, the most complex of which were a Feeder Protection Relay, the Communication Management Unit of a Boeing 737, and a Raspberry Pi.
The emulated firmware image also facilitates fuzz-testing, and a custom, architecture-independent fuzzer for QEMU, requiring no firmware modification, was used to discover a previously unknown privilege escalation vulnerability.

\subsubsection{Techniques}

The core of Jetset is composed into three parts: \emph{specification}, \emph{peripheral inference and synthesis} and \emph{search strategy}. 

The \emph{specification} fed to Jetset consists of three parts, which must be attained via alternative means.
\begin{itemize}
	\item The \textbf{binary code} of the target, which must be read out of a physical flash or extracted from the target by some other means.
	\item The \textbf{memory layout} of the target, which specifies how physical devices are mapped into the memory of the device, and is used to determine which reads and writes are key to peripheral inference.
	\item The \textbf{entry point} of the target, e.g. where execution begins. In this sense, Jetset attempts a \emph{brute force} inference of the target, by beginning inference from the absolute start of execution. This stands in contrast to InteGreat, discussed later.
	\item A \textbf{goal address} to reach within the target. Jetset explores \emph{a single} execution path to a specific firmware state, and employs a \emph{single} search strategy to get to this target. This again will stand in contrast to InteGreat.
\end{itemize}

This specification is then used to begin the process of \emph{peripheral inference and synthesis}, the former of which consists of symbolically executing the firmware to infer what values should be returned by reads from device registers.
The symbolic execution uses a taint-tracking system build on top of the QEMU TCG intermediate representation, paired with the angr constraint solver, to determine which read values are necessary to achieve a particular execution trace.
This union between taint tracking and symbolic execution was noted in~\cite{schwartz2010all}.

Importantly, work in this domain, including the famous SymQEMU~\cite{poeplau2021symqemu} and Jetset, ignore the necessity of symbolically executing the hundreds of TCG helper methods essential to QEMU~\cite{tcghelper}, which capture important microarchitectural operations, even as simple as branches, by directly modifying QEMU's state rather than by executing a TCG IR operation.
Thus, both Jetset and SymQEMU fail to account for significant microarchitectural semantics that are necessary for the soundness of the systems in the general case, even if they work on the evaluation targets persent in their publications.
\emph{Any} work based upon the TCG IR alone that does not address the helper methods will be unsound.
InteGreat addresses this problem with zero-length program slices that \emph{could} contain the semantics of TCG helper methods, though the goal of this paper is to provide a more general interface to some of the key problems of symbolic execution, rather than problems encountered when using QEMU.

The synthesis stage for peripherals recovers the specific model by making a call into angr's wrapper around the Z3 solver to find a concrete value that satisfies the constraints necessary to execute the desired program path.

\begin{figure}
\centering
%\includegraphics[width=8cm]{diagrams/distance_func.png}
\input{distance_func}
\caption{Context-sensitive distance from statement 5 (in first \texttt{foo} call) to statement 7 (of second \texttt{foo} call).}
\label{fig:distance_func}
\end{figure}

For the purposes of finding a goal location in the firmware, Jetset naively applies just a single \emph{search strategy} to locate a target execution point, a combination of Tabu search, a variation of depth-first search guided by a distance function with a list of ``avoid'' states and a context-sensitive distance function generated by resolving the callgraph of dynamically resolved function calls during symbolic execution.
The latter is achieved by ``stitching'' the discovered call target address during the symbolic execution into the recovered control flow graph so far.
An overview of this process is given in Fig.~\ref{fig:distance_func}.

By adding the context of the child-call CFG as calls are resolved at runtime, Jetset takes into account the fact that the distance between two instructions in a program can depend on the calling context, i.e. the call-stack of the two instructions.
Because programs may modify their own callstack to perform returns to different locations, distance from the goal location is computed lazily from the actual stack during execution.

When Jetset is not able to resolve a path to the target due to indirect or runtime-calculated function pointers, it alternates between resolving branches as \emph{true} or \emph{false}, allowing it to escape from exploring the same loop resolution condition infinitely.

\subsubsection{Methodology}

\input{data}

\begin{table*}
\small
\centering
\caption{Evaluation targets and summary statistics.}
\label{tab:targets}
\input{jetsettargets}
\vspace{\baselineskip} % Terrible, but out of time.
\end{table*}

Jetset's evaluation was dependent upon getting several firmware images into a steady state emulation, where the emulator would run without crashing.
The core targets for this evaluation were a Raspberry Pi 2, a single-board computer based on the Broadcom BCM2836 system-on-a-chip (SoC); a Collins Aerospace CMU-900, an electronic system used on many Boeing 737 aircraft, responsible for handling digital communications between the aircraft and ground stations with an AMD Am486, Intel 486-compatible processor; and a Schweitzer Engineering Laboratories SEL-751 feeder protection relay, used to protect power grid systems, leveraging a MCF54455, a 32-bit microprocessor implementing the ColdFire ISA.
The statistics on the emulation of these systems are given in Table~\ref{tab:targets}.

Details on the emulated and symbolically executed versions of the execution are given by the top and bottom portions of the table. 
Differences, in generally, are explanable due to the backtracking of symbolic execution when it hits an infinite loop (in these cases Jetset must re-execute code and take a different path), and due to slower inference-stage execution.
In the case of the Raspberry Pi, this led to an SD host controller command timeout, resulting in an error message and a register dump. 
During emulated execution with synthetic devices, the SD host controller initializes without a command timeout, thus, the executed blocks counts differ; however, the resulting emulation is resilient. 

While it was not addressed in the original publication, the testing of these systems also involved significant amounts of fuzz-testing using a custom built fuzzer that integrated AFL and QEMU, similar to FirmAFL~\cite{zheng2019firm}, but without requiring the modification of the target program.
It achieved this feat by performing a process-tree snapshot of the entire QEMU process while preserving speed by mounting QEMU's files into a RAM filesystem.
In the proposed dissertation, more detail on this fuzzer's implementation and the technical novelties would be provided---valuable due to the fact that the fuzzer has seen continued use after the paper's publication by a number of unaffiliated researchers.

The two targets of fuzzing were the Raspberry Pi and the CMU-900.
Both fuzzing sessions targeted the OS system call boundaries of Linux and VRTX, respectively.
While no novel vulnerabilities were found in Linux, all recovered fuzzing outputs were equivalent between the emulateed and physical versions of the Raspberry Pi.
The CMU-900, however, had significantly more successful results.
The AFL fuzzer found 2963 unique code paths during 200 hours of fuzzing, over 200 of which resulted in meaningful crashes.
One of these code paths, crashing on a function return, was bootstrapped into a privilege escalation vulnerability using a ROP chain by the author.

To validate this exploit on the physical device, for which the firmware version was different, the author had to build a ground truth QEMU emulation for the second firmware, and then write dataloading code to upload an also-handcrafted, shimmed version of the VRTX operating system which could inject the malicious system call at a realistic point in the physical device's execution.
This process was successful, and due to the complexity of relocating the shim code on the memory-constrained physical device while maintaining a true-to-reality execution of the system, required hundreds of lines of hand-written x86 assembly.

The discovery and crafting of this exploit would be further elucidated and detailed within the proposed thesis, and is valuable as it later led to the discovery of three remote denial-of-service vulnerabilities on the CMU-900 (unpublished), that cause the machine to crash due to maliciously crafted aircraft communication and reporting system (ACARS) messages.\footnote{Because ACARS messages also have a ``broadcast'' mode, these messages couldbe used to crash a large number of airplanes' CMU-900's simultaneously.}

\subsubsection{Discussion}

The Jetset work was a novel contribution to a yound domain of firmware rehosting, and thus, the techniques and methodologies adopted during symbolic execution and fuzzing had limitations. 
For one, the resulting emulation was not \emph{perfect}.
However, a perfect emulation was not necessary for useful results.
While Jetset only explored and inferred constraints for a single execution path, the results of fuzzing these emulations led to a real vulnerability that was disclosed to the embedded system's vendor.

For another, the current technical landscape of of symbolic execution and fuzzing on embedded systems is severely limited by support for microarchitectural abstractions, as, to the author's knowledge, all current embedded system fuzzers require modifications to the firmware under evaluation, and all symbolic executors fail to support all complex processor features, e.g. x86 task switching.
\emph{The proposed dissertation will address solutions to this limitation, both in the presentation of InteGreat and in detailing the construction of yAFL, the fuzzer Jetset used to discover the CMU-900 vulnerability.}

\subsection{Story Beyond the Eye}

In \emph{Story Beyond the Eye} we found that many current redactions of PDF text are insecure due to non-redacted character positioning information, determined by the \emph{glyph shifting} algorithms PDF producers use.
Subpixel-sized horizontal shifts in redacted and non-redacted characters can be recovered and used to effectively \emph{deredact} first and last names---these shifts add additional information to the width of redacted information and can be dependent upon redacted information but not themselves redacted.
These findings affected redactions where the text underneath the black box is removed from the PDF.

The system uses models of glyph shifting algorithms to correctly fingerprint the information left by redacted text, and was able to ``break'' hundreds of real-world PDF redactions, including in documents of historical relevance, OIG investigation reports, and FOIA responses.
The work also included an extensive notification of affected parties, demonstrating the broad impact of the work.

\subsubsection{Methodology}
\subsubsection{Techniques}
\subsubsection{Discussion}

\subsection{InteGreat}

InteGreat reinterprets bitvector-domain symbolic execution of program slices into the theory of uninterpreted functions to perform modular, nestable function summarization and decompilation.
The tool provides researchers with a novel design language for automatically abstracting complex programs into mathematical equations.
In the submitted publication, InteGreat's lifting was used to determine the sensor inputs necessary to precisely destabilize the reactor pressure of a chemical plant, discover novel problems in the domain of firmware rehosting, and discover a flaw in the implemented version of a published quad-copter stabilization algorithm.

\subsubsection{Methodology}
\subsubsection{Techniques}
\subsubsection{Discussion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 4: Management Plan %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Time Line and Management Plan}

\begin{table}[H]
\label{table1}
\renewcommand{\arraystretch}{0}
\caption{Project schedule.  PIs are Person One (P1), Person Two (P2), graduate student is GS, and the undergraduate student is US.\ Time frame gives the year each activity will occur.}
\scriptsize
\begin{tabularx}{\textwidth}{Y c c }
\hline
\hline
\textbf{Research Activity} & \textbf{Personnel} & \textbf{Time Frame}\\
\hline
Perform a task that sounds impressive & P2, US & Y1 \T\\
Perform another super-amazing task & P1, US & Y1 \T\\
Perform something else that may not be as sexy as the other things & P2, GS & Y1 \T\\
Wonder why you are such a terrible programmer & P1, US & Y1 \T\\
Analyze the results and stuff & P1, P2, SS & Y1,Y2 \T\\
Take the day off and grill some meat & P1, P2, SS & Y1,Y2 \T\\
Present findings at scientific meetings and publish results in peer-reviewed journals & P1, P2, US, GS & Y1, Y2, Y3\T\B\\
\hline
\hline
\end{tabularx}
\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 5: Science Merit   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Scientific Merit}

You wanna know how I got these scars? My father was\ldots a drinker, and a fiend. And one night, he goes off crazier than usual. Mommy gets the kitchen knife to defend herself. He doesn't like that, not one bit. So, me watching he takes the knife to her, laughing while he does it. He turns to me and he says: ``Why so serious?''. He comes at me with the knife ``Why so serious?''. He sticks the blade in my mouth. ``Let's put a smile on that face.'' and\ldots Why so serious?

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 6: Impact/Outreach %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Broader Impacts}
\label{broadimpacts}
\vspace*{-8pt}

This project will have direct impacts on research and education through access to simulation data products, student training, and K-12 outreach.  

\vspace{4pt}
\noindent \underline{\textit{Data Access}}: Maybe write about you will make data available.

\vspace{4pt}
\noindent \underline{\textit{Student Training}}: Write about how you will train students.

\vspace{4pt}
\noindent \underline{\textit{Some Other Outreach}}: Write about more outreach.

\vspace{4pt}
\noindent \underline{\textit{Dissemination}}: Write about how you will disseminate results (i.e., journal articles, workshops, etc).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section 7: Prior NSF Work  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results from Prior Work}

\noindent \emph{\underline{Person One}}: No NSF support in the past five years \newline

\noindent The most relevant prior NSF award to the proposed project for \underline{Person Two} (Co-PI) is: (a) NSF PDM \#\#\#\#\#\#\#, \$000,000, MM/DD/YY to MM/DD/YY; (b) Title: Super Cool Project That Got Funded; (c) Accomplishments related to the {\bf intellectual merit} of this research project include something something. The {\bf broader impacts} include outreach at many levels. Something Something. To date, the grant has funded one post-doc and 1000 graduate students. The project has also involved 500 undergraduate students. (d) To date this project has resulted in 100 conference presentations, one million journal publications (cite them) with one under review (cite it) and two in preparation with well-developed drafts.

\nocite*
